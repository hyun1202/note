# 동시성 문제란?
여러 쓰레드가 동시에 같은 인스턴스의 필드 값을 변경하면서 발생하는 문제를 동시성 문제라 한다.
	값을 읽기만 하면 상관 없으나 값을 변경하면 문제가 발생한다.

스레드 A가 값을 변경하고, 저장하기 전에 스레드 B가 값을 변경하면
스레드 A가 값을 읽어왔을 때 스레드 B가 변경한 값을 읽어오게 된다.

## ThreadLocal
해당 쓰레드만 접근할 수 있는 특별한 저장소
각 쓰레드 마다의 저장소를 가지고 있으므로 thread-safe하다.

```java
public ThreadLocal<String> threadLocal = new ThreadLocal<>();

threadLocal.set("asdf");
threadLocal.get();

// 반드시 사용 후 값을 제거해주어야함
threadLocal.remove();
```

> ❗️주의
> 쓰레드 로컬 사용 시에는 사용 후에 저장된 값을 제거해주어야 한다.
> 
> 쓰레드 풀을 사용하는 경우에 심각한 문제가 발생할 수 있다.> 
> was는 사용이 끝난 쓰레드를 쓰레드 풀에 반환(재사용)하는데, 이 때 쓰레드 저장소에 데이터도 살아있게 되어
> 요청이 완료된 후 반환되고 **다른 요청이 들어왔을 때 이전에 저장한 정보를 조회할 수 있게 되는 문제가 발생**한다.